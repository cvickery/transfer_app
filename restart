#! /usr/local/bin/bash

# Restart apache when “something” causes it to crash.
# Launchctl runs this every 5 minutes.

#echo -e "\n$(date)"
n=$(ps aux | ack 'httpd -D'| wc -l)
if [[ $n -lt 5 ]]
then echo -e "\n$n processes at $(date)"
  log show --predicate 'process == "httpd"' --last 10m
  brew services restart httpd
fi
